<!DOCTYPE html>




<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Preparing input data &mdash; Thetis User Guide</title>
    <meta name="description" content="">
    <meta name="author" content="">

    

<link rel="stylesheet" href="_static/css/basicstrap-base.css" type="text/css" />
<link rel="stylesheet" id="current-theme" href="_static/css/bootstrap3/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" id="current-adjust-theme" type="text/css" />

<link rel="stylesheet" href="_static/css/font-awesome.min.css">

<style type="text/css">
  body {
    padding-top: 60px;
    padding-bottom: 40px;
  }
</style>

<link rel="stylesheet" href="_static/css/basicstrap.css" type="text/css" />
<link rel="stylesheet" href="_static/pygments.css" type="text/css" />
<link rel="stylesheet" href="_static/css/text.css" type="text/css" />
<link rel="stylesheet" href="_static/css/toggle.css" type="text/css" />
    
<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
            URL_ROOT:    './',
            VERSION:     '0.2.2',
            COLLAPSE_INDEX: false,
            FILE_SUFFIX: '.html',
            HAS_SOURCE:  true
  };
</script>
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sphinx_highlight.js"></script>
    <script type="text/javascript" src="_static/js/bootstrap3.min.js"></script>
<script type="text/javascript" src="_static/js/jquery.cookie.min.js"></script>
<script type="text/javascript" src="_static/js/basicstrap.js"></script>
<script type="text/javascript">
</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Thetis User Guide" href="index.html" />
    <link rel="next" title="Key evaluation aspects" href="aspects.html" />
    <link rel="prev" title="Configuration" href="configuration.html" /> 
  </head>
  <body role="document">
    <div id="navbar-top" class="navbar navbar-fixed-top navbar-default" role="navigation" aria-label="top navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Thetis User Guide</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
              <li class="dropdown visible-xs">
                <a role="button" id="localToc" data-toggle="dropdown" data-target="#" href="#">Table Of Contents <b class="caret"></b></a>
                <ul class="dropdown-menu localtoc sp-localtoc" role="menu" aria-labelledby="localToc">
                <ul>
<li><a class="reference internal" href="#">Preparing input data</a><ul>
<li><a class="reference internal" href="#binary-classification">Binary classification</a></li>
<li><a class="reference internal" href="#multi-class-classification">Multi-class classification</a></li>
<li><a class="reference internal" href="#regression">Regression</a></li>
<li><a class="reference internal" href="#object-detection">Object detection</a></li>
</ul>
</li>
</ul>

                </ul>
              </li>

            
              <li><a href="configuration.html" title="Configuration" accesskey="P">previous </a></li>
              <li><a href="aspects.html" title="Key evaluation aspects" accesskey="N">next </a></li>
              <li><a href="genindex.html" title="General Index" accesskey="I">index </a></li>
            
            <li class="visible-xs"><a href="_sources/data.rst.txt" rel="nofollow">Show Source</a></li>

            <li class="visible-xs">
                <form class="search form-search form-inline navbar-form navbar-right sp-searchbox" action="search.html" method="get">
                  <div class="input-append input-group">
                    <input type="text" class="search-query form-control" name="q" placeholder="Search...">
                    <span class="input-group-btn">
                    <input type="submit" class="btn" value="Go" />
                    </span>
                  </div>
                  <input type="hidden" name="check_keywords" value="yes" />
                  <input type="hidden" name="area" value="default" />
                </form>
            </li>

            

          </ul>

        </div>
      </div>
    </div>
    

    <!-- container -->
    <div class="container-fluid">

      <!-- row -->
      <div class="row">
         
<div class="col-md-3 hidden-xs" id="sidebar-wrapper">
  <div class="sidebar hidden-xs" role="navigation" aria-label="main navigation">
<h3><a href="index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Preparing input data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#binary-classification">Binary classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multi-class-classification">Multi-class classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#regression">Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-detection">Object detection</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aspects.html">Key evaluation aspects</a></li>
<li class="toctree-l1"><a class="reference internal" href="subscription.html">Subscription and pricing</a></li>
</ul>

<div id="searchbox" role="search">
  <h3>Quick search</h3>
  <form class="search form-inline" action="search.html" method="get">
      <div class="input-append input-group">
        <input type="text" class="search-query form-control" name="q" placeholder="Search...">
        <span class="input-group-btn">
        <input type="submit" class="btn" value="Go" />
        </span>
      </div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
  </div>
</div> 
        

        <div class="col-md-9" id="content-wrapper">
          <div class="document" role="main">
            <div class="documentwrapper">
              <div class="bodywrapper">
                <div class="body">
                  
  <section id="preparing-input-data">
<h1>Preparing input data<a class="headerlink" href="#preparing-input-data" title="Permalink to this heading">¶</a></h1>
<p>The Thetis evaluation library only requires the output of an AI model on a dedicated evaluation dataset.
Thus, the application requires the ground truth target labels (not the data itself!) and the according AI predictions.
We give a detailed overview about the required data format in the following.</p>
<section id="binary-classification">
<h2>Binary classification<a class="headerlink" href="#binary-classification" title="Permalink to this heading">¶</a></h2>
<p>In the case of binary classification, Thetis expects two instances of a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas DataFrame</a> <code class="code docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>
representing the annotations and the model predictions on the dataset, respectively.</p>
<p>Imagine that we have the variables <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> with annotations and predictions, respectively.
If we print the content of <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> to the Python console, it might output the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annotations</span>
<span class="go">           target  gender    age</span>
<span class="go">img_00     person  female  adult</span>
<span class="go">img_01     person    male  child</span>
<span class="go">img_02     person  female  adult</span>
<span class="go">img_03     person  female  adult</span>
<span class="go">img_04     person  female  adult</span>
<span class="go">img_05     person  female  adult</span>
<span class="go">img_06  no person    male  adult</span>
<span class="go">img_07  no person  female  adult</span>
<span class="go">img_08     person  female  child</span>
<span class="go">img_09     person  female  child</span>
</pre></div>
</div>
<p>In this example, we have the available target classes “person” and “not person” with the sensitive
attributes “gender” and “age”. The target labels must always be given in the column <code class="code docutils literal notranslate"><span class="pre">target</span></code>. Furthermore,
each sensitive attribute must be given with its respective name as column name.</p>
<p>Accordingly, the output of <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> might look like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span>
<span class="go">           labels  confidence</span>
<span class="go">img_00     person    0.992300</span>
<span class="go">img_01     person    0.962620</span>
<span class="go">img_02  no person    0.146000</span>
<span class="go">img_03     person    0.795490</span>
<span class="go">img_04     person    0.897310</span>
<span class="go">img_05  no person    0.247210</span>
<span class="go">img_06  no person    0.001412</span>
<span class="go">img_07  no person    0.000150</span>
<span class="go">img_08     person    0.970410</span>
<span class="go">img_09     person    0.931941</span>
</pre></div>
</div>
<p>The required column <code class="code docutils literal notranslate"><span class="pre">labels</span></code> holds the predicted label for each item in the dataset, whereas the required
column <code class="code docutils literal notranslate"><span class="pre">confidence</span></code> represents the (binary) label confidence/uncertainty estimated by the AI model.</p>
<p><strong>Important:</strong> the <code class="code docutils literal notranslate"><span class="pre">confidence</span></code> refers to the <code class="code docutils literal notranslate"><span class="pre">binary_positive_label</span></code> specified in the <a class="reference external" href="#">application config</a>.
The uncertainty for the negative class (“no person” in this case) is given by <code class="code docutils literal notranslate"><span class="pre">1</span> <span class="pre">-</span> <span class="pre">confidence</span></code>.</p>
<p><strong>Note:</strong> the indices of the DataFrames <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> must match to each other.</p>
</section>
<section id="multi-class-classification">
<h2>Multi-class classification<a class="headerlink" href="#multi-class-classification" title="Permalink to this heading">¶</a></h2>
<p>If you are working in a multi-class classification setting (setting “task” to “classification” with more than 2 entries
in “distinct_classes” in the <a class="reference external" href="#">application config</a>), Thetis also expects two Pandas DataFrames <code class="code docutils literal notranslate"><span class="pre">annotations</span></code>
and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> representing the ground truth annotations and the according AI predictions, respectively.</p>
<p>Similar to the binary classification case, the DataFrame <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> must consist of the columns <code class="code docutils literal notranslate"><span class="pre">target</span></code>
as well as an own column for each specified sensitive attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annotations</span>
<span class="go">         target  gender    age</span>
<span class="go">img_00   person  female  adult</span>
<span class="go">img_01   person    male  child</span>
<span class="go">img_02      car    None   None</span>
<span class="go">img_03  bicycle    None   None</span>
<span class="go">img_04      car    None   None</span>
<span class="go">img_05   person  female  child</span>
<span class="go">img_06      car    None   None</span>
<span class="go">img_07   person  female  adult</span>
<span class="go">img_08   person    male  adult</span>
<span class="go">img_09  bicycle    None   None</span>
</pre></div>
</div>
<p><strong>Note:</strong> in this example, the sensitive attributes “gender” and “age” are only valid for the target class “person”.
This must be specified in the <a class="reference external" href="#">fairness section of the application config</a>. For all other entries, the
missing entries are marked by passing “None”.</p>
<p>The respective AI predictions given by <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> are given in a similar way compared to binary classification.
A column <code class="code docutils literal notranslate"><span class="pre">labels</span></code> is required, representing the predicted label of each individual sample.
However, an uncertainty/confidence is required for each possible class (e.g., the output of a Softmax activation function
in the context of neural networks). The columns for the confidence must follow the naming convention
<code class="code docutils literal notranslate"><span class="pre">confidence_&lt;label&gt;</span></code>. Thus, given a configuration for “distinct_classes” with possible classes “person”,
“bicycle”, and “car”, the DataFrame <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> for the AI predictions might look like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span>
<span class="go">         labels  confidence_person  confidence_bicycle  confidence_car</span>
<span class="go">img_00   person           0.984100            0.014250        0.001650</span>
<span class="go">img_01   person           0.948210            0.035340        0.016450</span>
<span class="go">img_02      car           0.001020            0.021920        0.977060</span>
<span class="go">img_03      car           0.021412            0.420190        0.558398</span>
<span class="go">img_04      car           0.030120            0.001390        0.968490</span>
<span class="go">img_05  bicycle           0.361530            0.591312        0.047158</span>
<span class="go">img_06      car           0.000326            0.005310        0.994364</span>
<span class="go">img_07   person           0.873920            0.004124        0.121956</span>
<span class="go">img_08   person           0.968320            0.020931        0.010749</span>
<span class="go">img_09   biycle           0.015182            0.947182        0.037636</span>
</pre></div>
</div>
<p><strong>Note:</strong> the indices of the DataFrames <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> must match to each other.</p>
</section>
<section id="regression">
<h2>Regression<a class="headerlink" href="#regression" title="Permalink to this heading">¶</a></h2>
<p>In the case of regression, Thetis expects two instances of a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas DataFrame</a> <code class="code docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>
representing the annotations (target scores) and the model predictions on the dataset, respectively.</p>
<p>Imagine that we have the variables <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> with annotations and predictions, respectively.
If we print the content of <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> to the Python console, it might output the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annotations</span>
<span class="go">            target  gender    age</span>
<span class="go">sample_00   -1.246  female  adult</span>
<span class="go">sample_01    0.579    male  child</span>
<span class="go">sample_02    0.000  female  adult</span>
<span class="go">sample_03  -10.798  female  adult</span>
<span class="go">sample_04    3.480  female  adult</span>
<span class="go">sample_05    9.546  female  adult</span>
<span class="go">sample_06   70.892    male  adult</span>
<span class="go">sample_07  -16.721  female  adult</span>
<span class="go">sample_08    0.239  female  child</span>
<span class="go">sample_09   -0.724  female  child</span>
</pre></div>
</div>
<p>In this example, we have the target scores with the sensitive
attributes “gender” and “age”. The target labels must always be given in the column <code class="code docutils literal notranslate"><span class="pre">target</span></code>. Furthermore,
each sensitive attribute must be given with its respective name as column name.</p>
<p>Accordingly, the output of <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> might look like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span>
<span class="go">          predictions  stddev</span>
<span class="go">sample_00     -0.524    1.272</span>
<span class="go">sample_01      2.725    0.713</span>
<span class="go">sample_02      0.011    0.005</span>
<span class="go">sample_03     -8.372    2.795</span>
<span class="go">sample_04     -2.745    3.657</span>
<span class="go">sample_05      9.546    0.001</span>
<span class="go">sample_06     60.126    9.001</span>
<span class="go">sample_07     -3.913    4.503</span>
<span class="go">sample_08     -0.342    0.098</span>
<span class="go">sample_09     -0.223    0.003</span>
</pre></div>
</div>
<p>The required column <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> holds the predicted scores for each item in the dataset. The <em>optional</em> column
<code class="code docutils literal notranslate"><span class="pre">stddev</span></code> holds the <em>estimated</em> standard deviation for each predicted score representing the estimation
uncertainty. Alternatively, the column <code class="code docutils literal notranslate"><span class="pre">variance</span></code> can also be passed with the according estimation variance.</p>
<p><strong>Note:</strong> when the evaluation of uncertainty is active, either column <code class="code docutils literal notranslate"><span class="pre">stddev</span></code> or <code class="code docutils literal notranslate"><span class="pre">variance</span></code> must be given.</p>
<p><strong>Note:</strong> the indices of the DataFrames <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> must match to each other.</p>
</section>
<section id="object-detection">
<h2>Object detection<a class="headerlink" href="#object-detection" title="Permalink to this heading">¶</a></h2>
<p>The input for the image-based object detection evaluation case differs compared to the classification cases.
In the object detection evaluation mode, Thetis expects two Python dictionaries <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and
<code class="code docutils literal notranslate"><span class="pre">predictions</span></code>, representing the ground truth objects as well as the predicted objects, respectively.</p>
<p>Each entry within these dictionaries must be an instance of a <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas DataFrame</a>.
The dictionary keys are the identifiers for each image. Thus, it is possible to assign predicted objects to real
existing ones by identifying the ground truth and prediction information using the given dictionary keys.</p>
<p>The individual <code class="code docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> instances (annotations and predictions) for each frame must be given according
to the format for <a class="reference external" href="BinaryClassification">binary classification</a> (but with more than 2 labels allowed). Thus, the
console output for <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> might look like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">annotations</span>
<span class="go">{&#39;__meta__&#39;:</span>
<span class="go">            width   height</span>
<span class="go">    img_00   1920     1080</span>
<span class="go">    img_01   1680     720,</span>

<span class="go"> &#39;img_00&#39;:</span>
<span class="go">         target  gender    age</span>
<span class="go">     0   person  female  adult</span>
<span class="go">     1   person    male  child</span>
<span class="go">     2      car    None   None</span>
<span class="go">     3   person  female  child</span>
<span class="go">     4      car    None   None</span>
<span class="go">     5   person  female  adult,</span>
<span class="go">&#39;img_01&#39;: ...</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>Important:</strong> the dictionary for <code class="code docutils literal notranslate"><span class="pre">annotations</span></code> <em>requires</em> a field <code class="code docutils literal notranslate"><span class="pre">__meta__</span></code> with an instance of
<code class="code docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> with columns <code class="code docutils literal notranslate"><span class="pre">width</span></code> and <code class="code docutils literal notranslate"><span class="pre">height</span></code>. This DataFrame holds the width and height meta
information for the respective image. The frame index must match the set of keys that are present in
<code class="code docutils literal notranslate"><span class="pre">annotations</span></code> and <code class="code docutils literal notranslate"><span class="pre">predictions</span></code>.</p>
<p>The console output for <code class="code docutils literal notranslate"><span class="pre">predictions</span></code> might look like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span>
<span class="go">{&#39;img_00&#39;:</span>
<span class="go">        labels  confidence</span>
<span class="go">    0   person    0.914123</span>
<span class="go">    1   person    0.871923</span>
<span class="go">    2      car    0.921751</span>
<span class="go">    3      car    0.993720</span>
<span class="go">    4      car    0.351152</span>
<span class="go">    5  bicycle    0.639153</span>
<span class="go">    6      car    0.817591</span>
<span class="go">    7   person    0.912730</span>
<span class="go">    8   person    0.981693</span>
<span class="go">    9   biycle    0.583190,</span>
<span class="go">&#39;img_01&#39;: ...</span>
<span class="go">}</span>
</pre></div>
</div>
<p><strong>Note:</strong> the indices of the individual <code class="code docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> instances are not expected to match each other since
the amount of predicted and real-existing objects can differ.</p>
<p>Furthermore, only a single field for <code class="code docutils literal notranslate"><span class="pre">confidence</span></code> is expected, even when working with multiple labels.
This is because most of the common object dection algorithms only output a single confidence estimate for a detected
object, discarding the confidence information for the remaining classes.</p>
</section>
</section>


                </div>
              </div>
            </div>
          </div>
        </div>
        
        
      </div><!-- /row -->

      <!-- row -->
      <div class="row footer-relbar">
<div id="navbar-related" class=" related navbar navbar-default" role="navigation" aria-label="related navigation">
  <div class="navbar-inner">
    <ul class="nav navbar-nav ">
        <li><a href="index.html">Thetis User Guide</a></li>
    </ul>
<ul class="nav navbar-nav pull-right hidden-xs hidden-sm">
      
        <li><a href="configuration.html" title="Configuration" >previous</a></li>
        <li><a href="aspects.html" title="Key evaluation aspects" >next</a></li>
        <li><a href="genindex.html" title="General Index" >index</a></li>
        <li><a href="#">top</a></li> 
      
    </ul>
  </div>
</div>
      </div><!-- /row -->

      <!-- footer -->
      <footer role="contentinfo">
      </footer>
      <!-- /footer -->

    </div>
    <!-- /container -->

  </body>
</html>